/*
 * FilePondPluginImageEdit 1.1.1
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */

/* eslint-disable */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.FilePondPluginImageEdit=t()}(this,function(){"use strict";var u=function(e){return/^image/.test(e.type)},e=function(e){var t=e.addFilter,i=e.utils,n=e.views,o=i.Type,r=i.createRoute,E=i.createItemAPI,d=void 0===E?function(e){return e}:E,f=n.fileActionButton;t("SHOULD_REMOVE_ON_REVERT",function(e,t){var i=t.item,n=t.query;return new Promise(function(e){var t=i.file;e(!(n("GET_ALLOW_IMAGE_PREVIEW")&&n("GET_ALLOW_IMAGE_EDIT")&&n("GET_IMAGE_EDIT_ALLOW_EDIT")&&u(t)))})}),t("DID_LOAD_ITEM",function(n,e){var o=e.query,l=e.dispatch;return new Promise(function(e,t){if(1<n.origin)e(n);else{var i=n.file;if(o("GET_ALLOW_IMAGE_PREVIEW")&&o("GET_ALLOW_IMAGE_EDIT")&&o("GET_IMAGE_EDIT_INSTANT_EDIT"))if(u(i)){var a=function(){if(c.length){var t,i,n,e=c[0],o=e.item,r=e.resolve,E=e.reject;l("EDIT_ITEM",{id:o.id,handleEditorResponse:(t=o,i=r,n=E,function(e){c.shift(),e?i(t):n(t),l("KICK"),a()})})}};I({item:n,resolve:e,reject:t}),1===c.length&&a()}else e(n);else e(n)}})}),t("DID_CREATE_ITEM",function(e,t){t.query;var i=t.dispatch;e.extend("edit",function(){i("EDIT_ITEM",{id:e.id})})});var c=[],I=function(e){return c.push(e),e};return t("CREATE_VIEW",function(e){var t=e.is,a=e.view,l=e.query;if(t("file")&&l("GET_ALLOW_IMAGE_PREVIEW")&&l("GET_ALLOW_IMAGE_EDIT")){var c=l("GET_IMAGE_EDIT_EDITOR");if(c){c.outputData=!0,c.outputFile=!1,c.cropAspectRatio=l("GET_IMAGE_CROP_ASPECT_RATIO")||c.cropAspectRatio,c.filepondCallbackBridge||(c.filepondCallbackBridge={onconfirm:c.onconfirm||function(){},oncancel:c.oncancel||function(){}});a.registerDestroyer(function(e){var t=e.root;t.ref.buttonEditItem&&t.ref.buttonEditItem.off("click",t.ref.handleEdit)}),a.registerWriter(r({DID_IMAGE_PREVIEW_SHOW:function(e){var t=e.root;t.ref.buttonEditItem&&(t.ref.buttonEditItem.opacity=1)},DID_LOAD_ITEM:function(e){var t=e.root,i=e.props;if(l("GET_IMAGE_EDIT_ALLOW_EDIT")){var n=i.id,o=l("GET_ITEM",n);if(o){var r=o.file;if(u(r)){var E=a.createChildView(f,{label:"edit",icon:l("GET_IMAGE_EDIT_ICON_EDIT"),opacity:0});E.element.classList.add("filepond--action-edit-item"),E.element.dataset.align=l("GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION"),t.ref.handleEdit=function(){return t.dispatch("EDIT_ITEM",{id:n})},E.on("click",t.ref.handleEdit),t.ref.buttonEditItem=a.appendChildView(E)}}}},EDIT_ITEM:function(e){var t=e.root,i=e.props,n=e.action,o=i.id,r=n.handleEditorResponse,E=t.query("GET_ITEM",o);if(E){var a=E.file,l={crop:E.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null}};c.onconfirm=function(e){var t=e.data,i=t.crop;E.setMetadata({crop:i}),c.filepondCallbackBridge.onconfirm(t,d(E)),r&&(c.onclose=function(){r(!0),c.onclose=null})},c.oncancel=function(){c.filepondCallbackBridge.oncancel(d(E)),r&&(c.onclose=function(){r(!1),c.onclose=null})},c.open(a,l)}}}))}}}),{options:{allowImageEdit:[!0,o.BOOLEAN],styleImageEditButtonEditItemPosition:["bottom center",o.STRING],imageEditInstantEdit:[!1,o.BOOLEAN],imageEditAllowEdit:[!0,o.BOOLEAN],imageEditIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',o.STRING],imageEditEditor:[null,o.OBJECT]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:e})),e});