/*
 * FilePondPluginImageEdit 1.1.1
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */

/* eslint-disable */
const isPreviewableImage=e=>/^image/.test(e.type);var plugin$1=e=>{const{addFilter:t,utils:i,views:o}=e,{Type:n,createRoute:E,createItemAPI:r=(e=>e)}=i,{fileActionButton:l}=o;t("SHOULD_REMOVE_ON_REVERT",(e,{item:t,query:i})=>new Promise(e=>{const{file:o}=t;e(!(i("GET_ALLOW_IMAGE_PREVIEW")&&i("GET_ALLOW_IMAGE_EDIT")&&i("GET_IMAGE_EDIT_ALLOW_EDIT")&&isPreviewableImage(o)))})),t("DID_LOAD_ITEM",(e,{query:t,dispatch:i})=>new Promise((o,n)=>{if(e.origin>1)return void o(e);const{file:E}=e;if(!t("GET_ALLOW_IMAGE_PREVIEW")||!t("GET_ALLOW_IMAGE_EDIT")||!t("GET_IMAGE_EDIT_INSTANT_EDIT"))return void o(e);if(!isPreviewableImage(E))return void o(e);const r=()=>{if(!a.length)return;const{item:e,resolve:t,reject:o}=a[0];i("EDIT_ITEM",{id:e.id,handleEditorResponse:((e,t,o)=>n=>{a.shift(),n?t(e):o(e),i("KICK"),r()})(e,t,o)})};d({item:e,resolve:o,reject:n}),1===a.length&&r()})),t("DID_CREATE_ITEM",(e,{query:t,dispatch:i})=>{e.extend("edit",()=>{i("EDIT_ITEM",{id:e.id})})});const a=[],d=e=>(a.push(e),e);return t("CREATE_VIEW",e=>{const{is:t,view:i,query:o}=e;if(!t("file")||!o("GET_ALLOW_IMAGE_PREVIEW")||!o("GET_ALLOW_IMAGE_EDIT"))return;const n=o("GET_IMAGE_EDIT_EDITOR");if(!n)return;n.outputData=!0,n.outputFile=!1,n.cropAspectRatio=o("GET_IMAGE_CROP_ASPECT_RATIO")||n.cropAspectRatio,n.filepondCallbackBridge||(n.filepondCallbackBridge={onconfirm:n.onconfirm||(()=>{}),oncancel:n.oncancel||(()=>{})});i.registerDestroyer(({root:e})=>{e.ref.buttonEditItem&&e.ref.buttonEditItem.off("click",e.ref.handleEdit)}),i.registerWriter(E({DID_IMAGE_PREVIEW_SHOW:({root:e})=>{e.ref.buttonEditItem&&(e.ref.buttonEditItem.opacity=1)},DID_LOAD_ITEM:({root:e,props:t})=>{if(!o("GET_IMAGE_EDIT_ALLOW_EDIT"))return;const{id:n}=t,E=o("GET_ITEM",n);if(!E)return;const r=E.file;if(!isPreviewableImage(r))return;const a=i.createChildView(l,{label:"edit",icon:o("GET_IMAGE_EDIT_ICON_EDIT"),opacity:0});a.element.classList.add("filepond--action-edit-item"),a.element.dataset.align=o("GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION"),e.ref.handleEdit=(()=>e.dispatch("EDIT_ITEM",{id:n})),a.on("click",e.ref.handleEdit),e.ref.buttonEditItem=i.appendChildView(a)},EDIT_ITEM:({root:e,props:t,action:i})=>{const{id:o}=t,{handleEditorResponse:E}=i,l=e.query("GET_ITEM",o);if(!l)return;const a=l.file,d={crop:l.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null}};n.onconfirm=(({data:e})=>{const{crop:t}=e;l.setMetadata({crop:t}),n.filepondCallbackBridge.onconfirm(e,r(l)),E&&(n.onclose=(()=>{E(!0),n.onclose=null}))}),n.oncancel=(()=>{n.filepondCallbackBridge.oncancel(r(l)),E&&(n.onclose=(()=>{E(!1),n.onclose=null}))}),n.open(a,d)}}))}),{options:{allowImageEdit:[!0,n.BOOLEAN],styleImageEditButtonEditItemPosition:["bottom center",n.STRING],imageEditInstantEdit:[!1,n.BOOLEAN],imageEditAllowEdit:[!0,n.BOOLEAN],imageEditIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',n.STRING],imageEditEditor:[null,n.OBJECT]}}};const isBrowser="undefined"!=typeof window&&void 0!==window.document;isBrowser&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin$1}));export default plugin$1;