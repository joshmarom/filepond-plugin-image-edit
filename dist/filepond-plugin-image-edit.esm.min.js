/*
 * FilePondPluginImageEdit 1.0.1
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */

/* eslint-disable */
const isPreviewableImage=e=>/^image/.test(e.type);var plugin$1=e=>{const{addFilter:t,utils:i,views:o}=e,{Type:E,createRoute:n}=i,{fileActionButton:r}=o;t("SHOULD_REMOVE_ON_REVERT",(e,{item:t,query:i})=>new Promise(e=>{const{file:o}=t;e(!(i("GET_ALLOW_IMAGE_PREVIEW")&&i("GET_ALLOW_IMAGE_EDIT")&&i("GET_IMAGE_EDIT_ALLOW_EDIT")&&isPreviewableImage(o)))})),t("DID_LOAD_ITEM",(e,{query:t,dispatch:i})=>new Promise((o,E)=>{const{file:n}=e;if(!t("GET_ALLOW_IMAGE_PREVIEW")||!t("GET_ALLOW_IMAGE_EDIT")||!t("GET_IMAGE_EDIT_INSTANT_EDIT"))return void o(e);if(!isPreviewableImage(n))return void o(e);const r=()=>{if(!l.length)return;const{item:e,resolve:t,reject:o}=l[0];i("EDIT_ITEM",{id:e.id,handleEditorResponse:((e,t,o)=>E=>{l.shift(),E?t(e):o(e),i("KICK"),r()})(e,t,o)})};I({item:e,resolve:o,reject:E}),1===l.length&&r()}));const l=[],I=e=>(l.push(e),e);return t("CREATE_VIEW",e=>{const{is:t,view:i,query:o}=e;if(!t("file")||!o("GET_ALLOW_IMAGE_PREVIEW")||!o("GET_ALLOW_IMAGE_EDIT"))return;const E=o("GET_IMAGE_EDIT_EDITOR");if(!E)return;E.outputData=!0,E.outputFile=!1,E.cropAspectRatio=o("GET_IMAGE_CROP_ASPECT_RATIO")||E.cropAspectRatio;i.registerDestroyer(({root:e})=>{e.ref.buttonEditItem&&e.ref.buttonEditItem.off("click",e.ref.handleEdit)}),i.registerWriter(n({DID_IMAGE_PREVIEW_SHOW:({root:e})=>{e.ref.buttonEditItem&&(e.ref.buttonEditItem.opacity=1)},DID_LOAD_ITEM:({root:e,props:t})=>{if(!o("GET_IMAGE_EDIT_ALLOW_EDIT"))return;const{id:E}=t,n=o("GET_ITEM",E);if(!n)return;const l=n.file;if(!isPreviewableImage(l))return;const I=i.createChildView(r,{label:"edit",icon:o("GET_IMAGE_EDIT_ICON_EDIT"),opacity:0});I.element.classList.add("filepond--action-edit-item"),I.element.dataset.align=o("GET_STYLE_IMAGE_EDIT_BUTTON_EDIT_ITEM_POSITION"),e.ref.handleEdit=(()=>e.dispatch("EDIT_ITEM",{id:E})),I.on("click",e.ref.handleEdit),e.ref.buttonEditItem=i.appendChildView(I)},EDIT_ITEM:({root:e,props:t,action:i})=>{const{id:o}=t,{handleEditorResponse:n}=i,r=e.query("GET_ITEM",o);if(!r)return;const l=r.file,I={crop:r.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null}};E.onconfirm=(({data:e})=>{const{crop:t}=e;r.setMetadata({crop:t}),n&&(E.onclose=(()=>{n(!0),E.onclose=null}))}),E.oncancel=(()=>{n&&(E.onclose=(()=>{n(!1),E.onclose=null}))}),E.open(l,I)}}))}),{options:{allowImageEdit:[!0,E.BOOLEAN],styleImageEditButtonEditItemPosition:["bottom center",E.STRING],imageEditInstantEdit:[!1,E.BOOLEAN],imageEditAllowEdit:[!0,E.BOOLEAN],imageEditIconEdit:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 17h1.586l7-7L15.5 8.414l-7 7V17zm-1.707-2.707l8-8a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1 0 1.414l-8 8A1 1 0 0 1 10.5 19h-3a1 1 0 0 1-1-1v-3a1 1 0 0 1 .293-.707z" fill="currentColor" fill-rule="nonzero"/></svg>',E.STRING],imageEditEditor:[null,E.OBJECT]}}};const isBrowser="undefined"!=typeof window&&void 0!==window.document;isBrowser&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin$1}));export default plugin$1;